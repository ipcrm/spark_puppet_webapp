ipcrm/sparkjava-puppet-webapp:
  Build:
    - echo "Built and tested with Jenkins"
  PkgInclude:
    - 'target/puppet-webapp-*.jar'
  PreInstall:
    - sudo yum install -y java-1.8.0-openjdk
  Exec:
    - java -jar target/puppet-webapp-*.jar
    - sudo iptables -I INPUT -p tcp -m multiport --dports 9999 -m comment --comment "110 allow http 9999 access" -j ACCEPT
    - publicip=$(curl -s ident.me) || true
    - 'echo "URL: http://$publicip:9999"'
